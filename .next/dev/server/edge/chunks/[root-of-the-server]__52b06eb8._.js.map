{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/lib/api/api.ts"],"sourcesContent":["\nimport axios from 'axios';\n\nconst baseURL = `${process.env.NEXT_PUBLIC_API_URL}/api`;\n\nexport const api = axios.create({\n  baseURL: baseURL,\n  withCredentials: true, \n}); "],"names":[],"mappings":";;;;AACA;;AAEA,MAAM,UAAU,6DAAmC,IAAI,CAAC;AAEjD,MAAM,MAAM,wJAAK,CAAC,MAAM,CAAC;IAC9B,SAAS;IACT,iBAAiB;AACnB"}},
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/lib/api/serverApi.ts"],"sourcesContent":["import { Note } from \"@/types/note\";\nimport { api } from \"./api\";\nimport { cookies } from \"next/headers\";\nimport { User } from \"@/types/user\";\nimport { AxiosResponse } from \"axios\";\n\ninterface NoteListData {\n  notes: Note[];\n  totalPages: number;\n}\n\n\nexport const fetchNotes = async (\n  search: string,\n  page: number,\n  tag?: string\n): Promise<NoteListData> => {\n  try {\n    const cookieStore = await cookies();\n    const res = await api.get<NoteListData>(\"/notes\", {\n      params: {\n        search,\n        page,\n        perPage: 12,\n        sortBy: \"created\",\n        tag,\n      },\n\n      headers: {\n      Cookie: cookieStore.toString(),\n    },\n    });\n\n    const result = res.data;\n    console.log(result);\n    return result;\n  } catch (error) {\n    console.log(error);\n    return { notes: [], totalPages: 0 };\n  }\n};\n\nexport const fetchNoteById = async (id: string): Promise<Note | null> => {\n  try {\n    const cookieStore = await cookies();\n    const res = await api.get<Note>(`/notes/${id}`, {\n      headers: {\n      Cookie: cookieStore.toString(),\n    },\n    });\n    return res.data;\n  } catch (error) {\n    console.log(error);\n    return null;\n  }\n};\n\nexport const checkServerSession = async (): Promise<AxiosResponse<User>> => {\n  const cookieStore = await cookies();\n  return api.get<User>(\"/auth/session\", {\n    headers: { Cookie: cookieStore.toString() },\n    withCredentials: true,\n  });\n};\nexport const getMe = async () : Promise<User>=> {\n  const cookieStore = await cookies();\n  const res = await api.get<User>(\"/users/me\", {\n    headers: {\n      Cookie: cookieStore.toString(),\n    },\n  });\n  return res.data;\n};"],"names":[],"mappings":";;;;;;;;;;AACA;AACA;AAAA;;;AAUO,MAAM,aAAa,OACxB,QACA,MACA;IAEA,IAAI;QACF,MAAM,cAAc,MAAM,IAAA,sLAAO;QACjC,MAAM,MAAM,MAAM,gIAAG,CAAC,GAAG,CAAe,UAAU;YAChD,QAAQ;gBACN;gBACA;gBACA,SAAS;gBACT,QAAQ;gBACR;YACF;YAEA,SAAS;gBACT,QAAQ,YAAY,QAAQ;YAC9B;QACA;QAEA,MAAM,SAAS,IAAI,IAAI;QACvB,QAAQ,GAAG,CAAC;QACZ,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,GAAG,CAAC;QACZ,OAAO;YAAE,OAAO,EAAE;YAAE,YAAY;QAAE;IACpC;AACF;AAEO,MAAM,gBAAgB,OAAO;IAClC,IAAI;QACF,MAAM,cAAc,MAAM,IAAA,sLAAO;QACjC,MAAM,MAAM,MAAM,gIAAG,CAAC,GAAG,CAAO,CAAC,OAAO,EAAE,IAAI,EAAE;YAC9C,SAAS;gBACT,QAAQ,YAAY,QAAQ;YAC9B;QACA;QACA,OAAO,IAAI,IAAI;IACjB,EAAE,OAAO,OAAO;QACd,QAAQ,GAAG,CAAC;QACZ,OAAO;IACT;AACF;AAEO,MAAM,qBAAqB;IAChC,MAAM,cAAc,MAAM,IAAA,sLAAO;IACjC,OAAO,gIAAG,CAAC,GAAG,CAAO,iBAAiB;QACpC,SAAS;YAAE,QAAQ,YAAY,QAAQ;QAAG;QAC1C,iBAAiB;IACnB;AACF;AACO,MAAM,QAAQ;IACnB,MAAM,cAAc,MAAM,IAAA,sLAAO;IACjC,MAAM,MAAM,MAAM,gIAAG,CAAC,GAAG,CAAO,aAAa;QAC3C,SAAS;YACP,QAAQ,YAAY,QAAQ;QAC9B;IACF;IACA,OAAO,IAAI,IAAI;AACjB"}},
    {"offset": {"line": 108, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport type { NextRequest } from \"next/server\";\nimport { checkServerSession } from \"./lib/api/serverApi\";\n\nconst privateRoutes = [\"/profile\", \"/notes\"];\nconst publicRoutes = [\"/sign-in\", \"/sign-up\"];\n\nexport async function middleware(req: NextRequest) {\n  const { pathname } = req.nextUrl;\n\n  const accessToken = req.cookies.get(\"accessToken\")?.value;\n  const refreshToken = req.cookies.get(\"refreshToken\")?.value;\n\n  const isPublicRoute = publicRoutes.some((route) => pathname.startsWith(route));\n  const isPrivateRoute = privateRoutes.some((route) => pathname.startsWith(route));\n\n  if (!accessToken) {\n    if (refreshToken) {\n      try {\n        const response = await checkServerSession();\n        const setCookie = response.headers[\"set-cookie\"];\n        const res = NextResponse.next();\n\n        setCookie?.forEach((cookieStr: string) => {\n          const [nameValue] = cookieStr.split(\"; \");\n          const [name, value] = nameValue.split(\"=\");\n          res.cookies.set(name, value, { httpOnly: true, path: \"/\" });\n        });\n\n        if (isPublicRoute) return NextResponse.redirect(new URL(\"/\", req.url), res);\n        if (isPrivateRoute) return res;\n      } catch (err) {\n        console.error(\"Failed to refresh session:\", err);\n        if (isPrivateRoute) return NextResponse.redirect(new URL(\"/sign-in\", req.url));\n        if (isPublicRoute) return NextResponse.next();\n      }\n    } else {\n      if (isPrivateRoute) return NextResponse.redirect(new URL(\"/sign-in\", req.url));\n      if (isPublicRoute) return NextResponse.next();\n    }\n  }\n\n  if (accessToken) {\n    if (isPublicRoute) return NextResponse.redirect(new URL(\"/\", req.url));\n    if (isPrivateRoute) return NextResponse.next();\n  }\n\n  return NextResponse.next();\n}\nexport const config = {\n  matcher: [\n    \"/profile/:path*\",  \n    \"/notes/:path*\",\n    \"/sign-in\",\n    \"/sign-up\",\n  ],\n};"],"names":[],"mappings":";;;;;;AAAA;AAAA;AAEA;;;AAEA,MAAM,gBAAgB;IAAC;IAAY;CAAS;AAC5C,MAAM,eAAe;IAAC;IAAY;CAAW;AAEtC,eAAe,WAAW,GAAgB;IAC/C,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAI,OAAO;IAEhC,MAAM,cAAc,IAAI,OAAO,CAAC,GAAG,CAAC,gBAAgB;IACpD,MAAM,eAAe,IAAI,OAAO,CAAC,GAAG,CAAC,iBAAiB;IAEtD,MAAM,gBAAgB,aAAa,IAAI,CAAC,CAAC,QAAU,SAAS,UAAU,CAAC;IACvE,MAAM,iBAAiB,cAAc,IAAI,CAAC,CAAC,QAAU,SAAS,UAAU,CAAC;IAEzE,IAAI,CAAC,aAAa;QAChB,IAAI,cAAc;YAChB,IAAI;gBACF,MAAM,WAAW,MAAM,IAAA,qJAAkB;gBACzC,MAAM,YAAY,SAAS,OAAO,CAAC,aAAa;gBAChD,MAAM,MAAM,gMAAY,CAAC,IAAI;gBAE7B,WAAW,QAAQ,CAAC;oBAClB,MAAM,CAAC,UAAU,GAAG,UAAU,KAAK,CAAC;oBACpC,MAAM,CAAC,MAAM,MAAM,GAAG,UAAU,KAAK,CAAC;oBACtC,IAAI,OAAO,CAAC,GAAG,CAAC,MAAM,OAAO;wBAAE,UAAU;wBAAM,MAAM;oBAAI;gBAC3D;gBAEA,IAAI,eAAe,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,IAAI,GAAG,GAAG;gBACvE,IAAI,gBAAgB,OAAO;YAC7B,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,8BAA8B;gBAC5C,IAAI,gBAAgB,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,YAAY,IAAI,GAAG;gBAC5E,IAAI,eAAe,OAAO,gMAAY,CAAC,IAAI;YAC7C;QACF,OAAO;YACL,IAAI,gBAAgB,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,YAAY,IAAI,GAAG;YAC5E,IAAI,eAAe,OAAO,gMAAY,CAAC,IAAI;QAC7C;IACF;IAEA,IAAI,aAAa;QACf,IAAI,eAAe,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,IAAI,GAAG;QACpE,IAAI,gBAAgB,OAAO,gMAAY,CAAC,IAAI;IAC9C;IAEA,OAAO,gMAAY,CAAC,IAAI;AAC1B;AACO,MAAM,SAAS;IACpB,SAAS;QACP;QACA;QACA;QACA;KACD;AACH"}}]
}